<head>
	<title>Meteorchat</title>

</head>
<body>
	{{>page}}
</body>

<template name="page">
	{{#if showAddContactDialog}}
		{{>addContactDialog}}
	{{/if}}
	{{#if currentUser}}
	<aside id="side-menu">
		<h1>Contacts</h1>
		<menu id="contacts" label="contacts" type="list">
			{{>contacts}}
		</menu>
		<h1>Settings</h1>
		<menu id="settings" label="settings" type="list">
			{{> settings}}
		</menu>
	</aside>
	{{/if}}
	<section id="main">
		<header>
			{{#if currentUser}}
				{{>header}}
			{{/if}}
		</header>
		<div id="content">
			{{#if currentUser}}
				<ol id="messages"><!-- an ordered list of messages, ordered by time -->
					{{> messages}}
					
				</ol>
				<form id="send-message-form">
					<input onkeypress="return event.keyCode!=13" type="text" placeholder="Write message">
					<button class="btn btn-primary" type="button">Send</button>
					</input>
				</form>
			{{else}} <!-- if We're not logged in -->
				<!--<form>
					<input id="email" type="email" placeholder="Email">
					<input id="password" type="password" placeholder="Password">
					<button id="login" type="button">Login</button>
					<button id="create" type="button">Create</button>
				</form>-->
				{{loginButtons}}
			{{/if}}
		</div>
	</section>
</template>


<template name="contacts">
	<button class="btn" id="add-contact" type="button">Add contact</button>
	{{#each contacts}}
		<li class="item">
			<a href="#"><img src="{{gravatar}}?s=40" alt="">
				<span>{{name}}</span>
			</a>
		</li>		
	{{/each}}
</template>

<template name="settings">
	<li class="item" onclick="Meteor.logout()">
		<a href="#" onclick="Meteor.logout()">
			<span>Logout</span>
		</a>
	</li>
</template>

<template name="messages">
	{{#each messages}}
		<li class="{{whichUser this}}">
			<article>
				<header>
					<h2>{{name}}</h2>
					<time pubtime datetime="{{timestamp}}">{{prettyDate timestamp}}</time>
				</header>
				<p>{{text}}</p>
			</article>
		</li>
	{{/each}}
</template>

<template name="header">
	<h1>{{username}}</h1>
</template>


<template name="addContactDialog">
	<div class="modal-backdrop"></div>
	<div class="modal">

		<div class="modal-body">
			{{#if error}}
				<div class="alert alert-error">{{error}}</div>
			{{/if}}

			<form>
			<fieldset>
				<legend>Add contact</legend>
				<label>
					Email address
					<input id="contact-email" type="email" required placeholder="Enter an email addressâ€¦">
				</label>

				<button type="submit" class="submit btn btn-primary">Add</button>
				<button class="btn cancel" type="button">Cancel</button>
			</fieldset>
			</form>
		</div>
	</div>
</template>